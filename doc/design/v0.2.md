# ğŸš€ SourceBridge é¡¹ç›®è®¾è®¡æ–‡æ¡£ (v0.2)

> **é¡¹ç›®åç§°**ï¼šSourceBridge
> **ç‰ˆæœ¬**ï¼šv0.2
> **æ—¥æœŸ**ï¼š2025-12-24
> **é¡¹ç›®ç±»å‹**ï¼šæ™ºèƒ½è·¨ç¯å¢ƒä»£ç åŒæ­¥ä¸ç®¡ç†æ¢çº½
> **æŠ€æœ¯æ ˆ**ï¼šTauri v2 + Rust + Vue 3 + SeaORM + Local AI

---

## ğŸ§­ ä¸€ã€é¡¹ç›®æ¦‚è¿°

**SourceBridge** æ­£åœ¨ä»ä¸€ä¸ªå•çº¯çš„ä»£ç åŒæ­¥å·¥å…·è¿›åŒ–ä¸º**é¡¹ç›®ç»ç† (PM) çš„æ™ºèƒ½å·¥ä½œæ¢çº½**ã€‚åœ¨ v0.1 çš„åŸºç¡€ä¸Šï¼Œv0.2 å¼•å…¥äº†**ä¸€é”®å·¥ä½œåŒº**ã€**æ™ºèƒ½çŠ¶æ€çœ‹æ¿**ã€**æœ¬åœ° AI é›†æˆ**å’Œ**è‡ªåŠ¨åŒ–æŠ¥å‘Š**ç­‰åŠŸèƒ½ï¼Œæ—¨åœ¨è¿›ä¸€æ­¥æå‡ PM åœ¨å¤šä»“åº“ã€å¤šç¯å¢ƒä¸‹çš„ç®¡ç†æ•ˆç‡ã€‚

### ğŸ”¹ æ ¸å¿ƒç›®æ ‡ (v0.2 Enhanced)
- **æé€Ÿå¯åŠ¨**ï¼šé€šè¿‡â€œä¸€é”®å·¥ä½œåŒºâ€ç¬é—´æ‰“å¼€é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰ IDEã€ç»ˆç«¯å’Œæ–‡ä»¶å¤¹ã€‚
- **æ™ºèƒ½ç›‘æ§**ï¼šå®æ—¶æ‰«æä»“åº“å¥åº·çŠ¶æ€ï¼ˆè½åã€æœªæäº¤ã€ä¾èµ–å†²çªï¼‰ï¼Œæä¾›å¯è§†åŒ–çœ‹æ¿ã€‚
- **AI èµ‹èƒ½**ï¼šé›†æˆæœ¬åœ° AI (Ollama/OpenAI)ï¼Œæä¾›æ™ºèƒ½ Diff è§£é‡Šã€Release Notes ç”Ÿæˆå’Œè‡ªåŠ¨åŒ– AI ä»»åŠ¡æµã€‚
- **è‡ªåŠ¨åŒ–æŠ¥å‘Š**ï¼šè‡ªåŠ¨æ±‡æ€»å‘¨æŠ¥ï¼Œå‡å°‘æ–‡æ¡£ç¼–å†™æ—¶é—´ã€‚
- **æè‡´æ€§èƒ½**ï¼šä¿æŒ Rust æ ¸å¿ƒä¼˜åŠ¿ï¼Œå¼‚æ­¥å¤„ç†æ‰€æœ‰ I/O å’Œ git æ“ä½œã€‚

---

## âš™ï¸ äºŒã€æŠ€æœ¯æ ˆ

| å±‚çº§         | æŠ€æœ¯é€‰å‹                   | è¯´æ˜                                     |
| ------------ | -------------------------- | ---------------------------------------- |
| **UI å‰ç«¯**  | **Vue 3 + TypeScript**     | TailwindCSS + ShadcnUI + Monaco Editor   |
| **å›½é™…åŒ–**   | **vue-i18n**               | å…¨é¢æ”¯æŒå¤šè¯­è¨€åˆ‡æ¢                       |
| **åº”ç”¨æ¡†æ¶** | **Tauri v2**               | è´Ÿè´£çª—å£ç®¡ç†ã€ç³»ç»ŸåŸç”ŸæŒ‡ä»¤è°ƒç”¨           |
| **æ ¸å¿ƒåç«¯** | **Rust**                   | ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒï¼Œé«˜æ€§èƒ½å¹¶è¡Œå¤„ç†             |
| **AI å¼•æ“**  | **Reqwest + Ollama API**   | (New) è°ƒç”¨æœ¬åœ°æˆ–è¿œç¨‹ LLM æ¥å£            |
| **ORM**      | **SeaORM**                 | (Enhanced) å¼‚æ­¥ ORMï¼ŒCode-First è¿ç§»ç®¡ç† |
| **è°ƒåº¦å™¨**   | **tokio-cron-scheduler**   | ä»»åŠ¡ç¼–æ’ä¸å®šæ—¶æ‰§è¡Œ                       |
| **Git æ“ä½œ** | **git2-rs / std::process** | æ ¸å¿ƒ Git èƒ½åŠ›                            |

---

## ğŸ§© ä¸‰ã€ç³»ç»Ÿæ¶æ„ (Updated)

```text
+-------------------------------------------------------------------+
|                     SourceBridge GUI Window                       |
|  [Dashboard + Status] [Workspace Ops] [Task Builder] [AI Chat]    |
+--------------------------------+----------------------------------+
                                 |
                        (Rust Backend / Tauri)
                                 v
+-------------------------------------------------------------------+
| Core Services                                             |
| --------------------------------------------------------- |
| 1. Orchestrator Service (Tasks & Pipelines)               |
| â”œâ”€â”€ Step: AI Prompt (New)                                 |
| â””â”€â”€ ... (Script, Git, Sync)                               |
| 2. AI Service (New) --> [Ollama / OpenAI API]             |
| 3. Scanner Service (New) --> [Repo Health & Dependencies] |
| 4. Workspace Service (New) --> [System launcher commands] |
+-------------------------------------------------------------------+
                                 |
                        (Data Access Layer)
                                 v
+-------------+      +-------------+      +-------------+
| Repo Entity |      | Route Entity|      | Report Eng. |
| (SeaORM)    |      | (SeaORM)    |      | (Generator) |
+-------------+      +-------------+      +-------------+
```

---

## ğŸ§± å››ã€æ ¸å¿ƒåŠŸèƒ½æ¨¡å— (v0.2 Features)

### 1ï¸âƒ£ å·¥ä½œåŒºä¸æ•ˆç‡ (Workspace & Efficiency)
- **One-Click Workspace**: 
  - åœ¨è·¯ç”±åˆ†ç»„ (`Route Group`) çº§åˆ«é…ç½®ã€‚
  - å•å‡»å³å¯å¹¶å‘æ‰“å¼€ï¼šSource æ–‡ä»¶å¤¹/IDEã€Target æ–‡ä»¶å¤¹ã€Terminalã€‚
  - å‡å°‘æ‰‹åŠ¨ `cd` å’Œæ‰“å¼€ç¼–è¾‘å™¨çš„æ—¶é—´ã€‚

### 2ï¸âƒ£ æ™ºèƒ½çŠ¶æ€ä¸è¯Šæ–­ (Smart Scanner)
- **Git Status Scanner**: 
  - å¼‚æ­¥æ‰¹é‡æ‰«ææ‰€æœ‰ä»“åº“ã€‚
  - çŠ¶æ€åˆ†ç±»ï¼š`Clean`, `Uncommitted`, `Behind`, `Detached`, `Conflict`ã€‚
- **Dependency Scanner**:
  - è§£æ `package.json` / `Cargo.toml`ã€‚
  - è¯­ä¹‰åŒ–ç‰ˆæœ¬å¯¹æ¯”ï¼Œé¢„è­¦ Major ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„æ½œåœ¨é€»è¾‘å†²çªã€‚

### 3ï¸âƒ£ æœ¬åœ° AI é›†æˆ (Local AI)
- **Smart Context Menu**:
  - **Explain Diff**: é€‰ä¸­ä»£ç å·®å¼‚ï¼ŒAI è§£é‡Šä¸šåŠ¡å«ä¹‰ã€‚
  - **Generate Release Notes**: è‡ªåŠ¨åˆ†æ Commit Log å’Œ Diffï¼Œç”Ÿæˆ Markdown æ—¥å¿—ã€‚
- **AI Task Node**:
  - åœ¨ä»»åŠ¡ç¼–æ’ä¸­å¢åŠ  `AI_PROMPT` èŠ‚ç‚¹ã€‚
  - è¾“å…¥ï¼šä¸Šæ¸¸ Git Log / Diffã€‚
  - è¾“å‡ºï¼šå†™å…¥ `CHANGELOG.md` æˆ–å‘é€é€šçŸ¥ã€‚

### 4ï¸âƒ£ è‡ªåŠ¨åŒ–æŠ¥å‘Š (Automated Reporting)
- **Weekly Report**: 
  - è‡ªåŠ¨èšåˆè¿‡å» 7 å¤©çš„åŒæ­¥è®°å½•ã€Commit æ•°é‡ã€è¦†ç›–çš„ Issueã€‚
  - ç”Ÿæˆ Markdown æ ¼å¼æŠ¥å‘Šï¼Œæ”¯æŒé¢„è§ˆå’Œå¯¼å‡ºã€‚

---

## ğŸ§° äº”ã€æ•°æ®åº“è®¾è®¡æ›´æ–° (Schema Changes)

### 1. è·¯ç”±åˆ†ç»„å¢å¼º (Workspaces)
åœ¨ `route_groups` è¡¨ä¸­å¢åŠ é…ç½®å­—æ®µï¼Œç”¨äºå­˜å‚¨å·¥ä½œåŒºè®¾ç½®ã€‚

```sql
-- æœ¬æ¬¡ä¸éœ€è¦æ–°å»ºè¡¨ï¼Œåªéœ€å¢åŠ å­—æ®µ (é€šè¿‡ Migration)
ALTER TABLE route_groups ADD COLUMN workspace_config TEXT; 
-- workspace_config JSON ç»“æ„ç¤ºä¾‹:
-- {
--   "source_ide_cmd": "code .",
--   "target_ide_cmd": "cursor .",
--   "open_terminals": true
-- }
```

### 2. å…¨å±€è®¾ç½®å¢å¼º (AI Config)
åˆ©ç”¨ç°æœ‰çš„ `settings` è¡¨å­˜å‚¨ AI é…ç½®ã€‚

| Key           | Value Example            |
| ------------- | ------------------------ |
| `ai_provider` | `ollama` / `openai`      |
| `ai_endpoint` | `http://localhost:11434` |
| `ai_model`    | `llama3` / `gpt-4o`      |
| `ai_api_key`  | `sk-xxxx` (Optional)     |

### 3. ä»»åŠ¡æ­¥éª¤å¢å¼º (AI Steps)
`task_steps` è¡¨çš„ `action_type` æšä¸¾å¢åŠ ï¼š
- `ai_prompt`: æ‰§è¡Œ AI æŒ‡ä»¤ã€‚
- `generate_report`: ç”ŸæˆæŠ¥å‘Šã€‚

---

## ğŸªœ å…­ã€å¼€å‘è·¯çº¿å›¾ (Updated)

| é˜¶æ®µ               | ç›®æ ‡            | æ ¸å¿ƒä»»åŠ¡                                              |
| ------------------ | --------------- | ----------------------------------------------------- |
| **Old Phases 1-4** | **Foundation**  | å·²å®ŒæˆåŸºç¡€æ¶æ„ã€Repo/Routeç®¡ç†ã€ä»»åŠ¡ç¼–æ’åŸºç¡€ã€‚        |
| **New Phase 1**    | **Workspace**   | å®ç° `open_path` æŒ‡ä»¤ï¼ŒRouteGroup å¢åŠ å·¥ä½œåŒºé…ç½® UIã€‚ |
| **New Phase 2**    | **Diagnostics** | å®ç°å¼‚æ­¥ Git æ‰«æå™¨ã€ä¾èµ–è§£æå™¨ã€Dashboard çŠ¶æ€çœ‹æ¿ã€‚ |
| **New Phase 3**    | **Local AI**    | é›†æˆ `reqwest` è°ƒç”¨ LLMï¼Œå®ç°å³é”® AI èœå•ã€‚           |
| **New Phase 4**    | **Advanced**    | å®ç°å‘¨æŠ¥ç”Ÿæˆå™¨ï¼Œæ‰©å±•ä»»åŠ¡å¼•æ“æ”¯æŒ AI èŠ‚ç‚¹ã€‚            |

---

## ğŸ—‚ ä¸ƒã€æ–‡ä»¶ç»“æ„æ–°å¢å»ºè®®

```bash
src-tauri/src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ ai/               # AI Service Module
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ client.rs     # Ollama/OpenAI Client
â”‚   â”‚   â””â”€â”€ prompts.rs    # System Prompts
â”‚   â”œâ”€â”€ scanner/          # Diagnostics Module
â”‚   â”‚   â”œâ”€â”€ git_status.rs
â”‚   â”‚   â””â”€â”€ dependencies.rs
â”‚   â””â”€â”€ report/           # Reporting Module
â”‚       â””â”€â”€ weekly.rs
```
